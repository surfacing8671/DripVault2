{"version":3,"sources":["../../../src/parsers/array.ts"],"names":["ARRAY_REGEX","getArrayType","type","match","Error","array","isDynamic","isType","test","encode","buffer","value","arrayType","arrayLength","length","Array","fill","decode","Number","subarray"],"mappings":";;;;;;;AAAA;;AAEA;;AAGA,MAAMA,WAAW,GAAG,WAApB;;AAQO,MAAMC,YAAY,GAAIC,IAAD,IAA0B;AACpD,QAAMC,KAAK,GAAGD,IAAI,CAACC,KAAL,CAAWH,WAAX,CAAd;;AACA,MAAIG,KAAJ,EAAW;AACT,WAAOA,KAAK,CAAC,CAAD,CAAZ;AACD;;AAED,QAAM,IAAIC,KAAJ,CAAU,2BAAV,CAAN;AACD,CAPM;;;AASA,MAAMC,KAAwB,GAAG;AACtCC,EAAAA,SAAS,EAAE,IAD2B;;AAStCC,EAAAA,MAAM,CAACL,IAAD,EAAwB;AAC5B,WAAOF,WAAW,CAACQ,IAAZ,CAAiBN,IAAjB,CAAP;AACD,GAXqC;;AAatCO,EAAAA,MAAM,CAAC;AAAEP,IAAAA,IAAF;AAAQQ,IAAAA,MAAR;AAAgBC,IAAAA;AAAhB,GAAD,EAAsC;AAC1C,UAAMC,SAAS,GAAGX,YAAY,CAACC,IAAD,CAA9B;AACA,UAAMW,WAAW,GAAG,qBAASF,KAAK,CAACG,MAAf,CAApB;AAEA,WAAO,kBAAK,IAAIC,KAAJ,CAAUJ,KAAK,CAACG,MAAhB,EAAwBE,IAAxB,CAA6BJ,SAA7B,CAAL,EAA8CD,KAA9C,EAAqD,mBAAO,CAACD,MAAD,EAASG,WAAT,CAAP,CAArD,CAAP;AACD,GAlBqC;;AAoBtCI,EAAAA,MAAM,CAAC;AAAEf,IAAAA,IAAF;AAAQS,IAAAA;AAAR,GAAD,EAAyC;AAC7C,UAAMC,SAAS,GAAGX,YAAY,CAACC,IAAD,CAA9B;AACA,UAAMW,WAAW,GAAGK,MAAM,CAAC,qBAASP,KAAK,CAACQ,QAAN,CAAe,CAAf,EAAkB,EAAlB,CAAT,CAAD,CAA1B;AAEA,WAAO,oBAAO,IAAIJ,KAAJ,CAAUF,WAAV,EAAuBG,IAAvB,CAA4BJ,SAA5B,CAAP,EAA+CD,KAAK,CAACQ,QAAN,CAAe,EAAf,CAA/C,CAAP;AACD;;AAzBqC,CAAjC","sourcesContent":["import { pack, unpack } from '../packer';\nimport { DecodeArgs, Parser } from '../types';\nimport { concat, toBuffer, toNumber } from '../utils';\n\n// TODO: Add support for fixed length arrays\nconst ARRAY_REGEX = /^(.*)\\[]$/;\n\n/**\n * Get the type of the array.\n *\n * @param type The type to get the array type for.\n * @return The array type.\n */\nexport const getArrayType = (type: string): string => {\n  const match = type.match(ARRAY_REGEX);\n  if (match) {\n    return match[1];\n  }\n\n  throw new Error('Type is not an array type');\n};\n\nexport const array: Parser<unknown[]> = {\n  isDynamic: true,\n\n  /**\n   * Check if a type is an array type.\n   *\n   * @param type The type to check.\n   * @return Whether the type is a array type.\n   */\n  isType(type: string): boolean {\n    return ARRAY_REGEX.test(type);\n  },\n\n  encode({ type, buffer, value }): Uint8Array {\n    const arrayType = getArrayType(type);\n    const arrayLength = toBuffer(value.length);\n\n    return pack(new Array(value.length).fill(arrayType), value, concat([buffer, arrayLength]));\n  },\n\n  decode({ type, value }: DecodeArgs): unknown[] {\n    const arrayType = getArrayType(type);\n    const arrayLength = Number(toNumber(value.subarray(0, 32)));\n\n    return unpack(new Array(arrayLength).fill(arrayType), value.subarray(32));\n  }\n};\n"],"file":"array.js"}